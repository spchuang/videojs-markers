/*! videojs-markers - v0.4.0 - 2014-12-14
* Copyright (c) 2014 ; Licensed  */
"use strict";!function(a,b){function c(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function d(b){function d(b){var d=q.duration();a.each(b,function(b,e){e.position=e.time/d*100,e.key=c(),e.div=a("<div class='vjs-marker' data-marker-index='"+e.key+"'></div>"),e.div.css(m.markerStyle).css({"margin-left":-parseFloat(e.div.css("width"))/2+"px",left:e.position+"%"}),e["class"]&&e.div.addClass(e["class"]),e.text=e.text||"",e.overlay=e.overlay||"",p.find(".vjs-progress-control").append(e.div),n[e.key]=e,o.push(e),e.div.on("click",function(){var b=a(this).data("marker-index");q.currentTime(n[b].time)}),m.markerTip.display&&g(e.div)}),o.sort(function(a){return-a.time})}function f(a){s&&(l=-1,s.css("visibility","hidden"));for(var b=0;b<a.length;b++){var c=a[b],d=o[c];d&&(delete n[d.key],o[c]=null,p.find(".vjs-marker[data-marker-index='"+d.key+"']").remove())}for(var b=o.length-1;b>=0;b--)null===o[b]&&o.splice(b,1);o.sort(function(a){return-a.time})}function g(b){b.on("mouseover",function(){var b=a(this).data("marker-index");r.find(".vjs-tip-inner").text(m.markerTip.text(n[b])),r.css({left:n[b].position+"%","margin-left":-parseFloat(r.css("width"))/2-5+"px",visibility:"visible"})}).on("mouseout",function(){r.css("visibility","hidden")})}function h(){r=a("<div class='vjs-tip'><div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div></div>"),p.find(".vjs-progress-control").append(r)}function i(){var c=q.currentTime();-1==l?a.each(n,function(a,d){return c>=d.time&&c<=d.time+m.breakOverlay.displayTime?(l=d.key,s.find(".vjs-break-overlay-text").text(m.breakOverlay.text(d)),s.css("visibility","visible"),b.onMarkerReached&&b.onMarkerReached(d),!1):void 0}):(c<n[l].time||c>n[l].time+m.breakOverlay.displayTime)&&(l=-1,s.css("visibility","hidden"))}function j(){s=a("<div class='vjs-break-overlay'><div class='vjs-break-overlay-text'></div></div>").css(m.breakOverlay.style),p.append(s),l=-1}function k(){m.markerTip.display&&h(),q.markers.removeAll(),d(b.markers),m.breakOverlay.display&&(j(),q.on("timeupdate",i))}var l,m=a.extend(!0,{},e,b.setting),n={},o=[],p=a(this.el()),q=this,r=null,s=null;q.on("loadedmetadata",function(){k()}),q.markers={next:function(){for(var a=q.currentTime(),b=0;b<o.length;b++)if(o[b].time>a)return q.currentTime(o[b].time),!1},prev:function(){for(var a=q.currentTime(),b=o.length-1;b>=0;b--)if(o[b].time+.5<a)return q.currentTime(o[b].time),!1},add:function(a){d(a)},remove:function(a){f(a)},removeAll:function(){for(var a=[],b=0;b<o.length;b++)a.push(b);f(a)},reset:function(a){q.markers.removeAll(),d(a)},destroy:function(){q.markers.removeAll(),s.remove(),r.remove(),q.off("timeupdate",i),delete q.markers,delete q.getMarkers}}}var e={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(a){return"Break: "+a.text}},breakOverlay:{display:!1,displayTime:3,text:function(a){return"Break overlay: "+a.text},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerReached:function(){},markers:[]};b.plugin("markers",d)}(jQuery,window.videojs);