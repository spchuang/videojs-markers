/*! videojs-markers - v0.4.0 - 2015-04-09
* Copyright (c) 2015 ; Licensed  */
"use strict";!function(a,b,c){function d(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b}function e(b){function c(){p.sort(function(a,b){return a.time-b.time})}function e(b){var e=s.duration();a.each(b,function(b,c){c.position=c.time/e*100,c.key=d(),c.div=a("<div class='vjs-marker' data-marker-index='"+c.key+"'></div>"),c.div.css(n.markerStyle).css({"margin-left":-parseFloat(c.div.css("width"))/2+"px",left:c.position+"%"}),c["class"]&&c.div.addClass(c["class"]),c.text=c.text||"",c.overlayText=c.overlayText||"",q.find(".vjs-progress-control").append(c.div),o[c.key]=c,p.push(c),c.div.on("click",function(b){var d=a(this).data("marker-index");s.currentTime(o[d].time),c.onMarkerClicked&&c.onMarkerClicked()}),n.markerTip.display&&h(c.div)}),c()}function g(a){u&&(v=-1,u.css("visibility","hidden")),r=-1;for(var b=0;b<a.length;b++){var d=a[b],e=p[d];e&&(delete o[e.key],p[d]=null,q.find(".vjs-marker[data-marker-index='"+e.key+"']").remove())}for(var b=p.length-1;b>=0;b--)null===p[b]&&p.splice(b,1);c()}function h(b){b.on("mouseover",function(){var b=a(this).data("marker-index");t.find(".vjs-tip-inner").text(n.markerTip.text(o[b])),t.css({left:o[b].position+"%","margin-left":-parseFloat(t.css("width"))/2-5+"px",visibility:"visible"})}).on("mouseout",function(){t.css("visibility","hidden")})}function i(){t=a("<div class='vjs-tip'><div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div></div>"),q.find(".vjs-progress-control").append(t)}function j(a){if(!(0>r)){var b=p[r];a>=b.time&&a<=b.time+n.breakOverlay.displayTime?(v!=r&&(v=r,u.find(".vjs-break-overlay-text").text(n.breakOverlay.text(b))),u.css("visibility","visible")):(v=-1,u.css("visibility","hidden"))}}function k(){u=a("<div class='vjs-break-overlay'><div class='vjs-break-overlay-text'></div></div>").css(n.breakOverlay.style),q.append(u),v=-1}function l(){var a,c=s.currentTime();if(p.length>0&&c<p[0].time)a=-1;else for(var d=0;d<p.length;d++){var e=s.duration();d<p.length-1&&(e=p[d+1].time),c>=p[d].time&&e>c&&(a=d)}a!=r&&(-1!=a&&b.onMarkerReached&&b.onMarkerReached(p[a]),r=a),n.breakOverlay.display&&j(c)}function m(){n.markerTip.display&&i(),s.markers.removeAll(),e(b.markers),n.breakOverlay.display&&k(),s.on("timeupdate",l)}var n=a.extend(!0,{},f,b),o={},p=[],q=a(this.el()),r=-1,s=this,t=null,u=null,v=-1;s.on("loadedmetadata",function(){m()}),s.markers={next:function(){for(var a=s.currentTime(),b=0;b<p.length;b++)if(p[b].time>a)return s.currentTime(p[b].time),!1},prev:function(){for(var a=s.currentTime(),b=p.length-1;b>=0;b--)if(p[b].time+.5<a)return s.currentTime(p[b].time),!1},add:function(a){e(a)},remove:function(a){g(a)},removeAll:function(){for(var a=[],b=0;b<p.length;b++)a.push(b);g(a)},reset:function(a){s.markers.removeAll(),e(a)},destroy:function(){s.markers.removeAll(),u.remove(),t.remove(),s.off("timeupdate",j),delete s.markers,delete s.getMarkers}}}var f={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(a){return"Break: "+a.text}},breakOverlay:{display:!1,displayTime:3,text:function(a){return"Break overlay: "+a.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerReached:function(a){},markers:[]};b.plugin("markers",e)}(jQuery,window.videojs);